<html>
<head>
  <title>Pearl Symphony</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
     <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
  <style>
    #map{ 
    height: 100%;
    }
    .info {
    padding: 18px 24px;
    font: 14px/16px Arial, Helvetica, sans-serif;
    background: rgba(365,365,365,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    color: black;
    border-radius: 5px;
    line-height: 1.6;
    max-width: 400px;
    word-wrap: break-word;
    pointer-events: none;
    }
    .info h4 {
    margin: 0 0 5px;
    color: #777;
    }
    .legend {
    padding: 10px 10px;
    background: rgba(365,365,365,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    pointer-events: none;
    }
    span.b {
    position: relative;
    top: 6px;
    margin-left:0.8em;
    margin-right:0.8em;
    }
    .above {
    position: relative;
    display: inline-block;
    margin-bottom: 1em;
    }
    .above .below {
    position: absolute;
    width: 100%;
    left: 0;
    top: 80%;
    text-align: center;
    }
    @media only screen and (min-device-width: 320px) and (max-device-width: 480px) {
        .info {
        padding: 36px 48px;
        font: 28px/32px Arial, Helvetica, sans-serif;
        background: rgba(365,365,365,0.8);
        box-shadow: 0 0 30px rgba(0,0,0,0.2);
        color: black;
        border-radius: 10px;
        line-height: 1.6;
        max-width: 800px;
        word-wrap: break-word;
        pointer-events: none;
        }
        .info h4 {
        margin: 0 0 10px;
        color: #777;
        }
    }
  </style>
</head>
<body>
    
  <div id="map"></div>
  <script>

  var bounds = [[0,0], [4960,3508]];
  var map = L.map('map', {
      crs: L.CRS.Simple,
      maxZoom: -1,
      minZoom: -3,
      maxBounds: [[-750,-750], [5710,4258]],
      maxBoundsViscosity: 1.0,
      zoomAnimation: false,
      zoomControl: false,
      doubleClickZoom: false
    });

  var detaljna_mapa = L.imageOverlay('Working verzija.jpg', bounds).addTo(map);
  map.fitBounds(bounds);

//############################################################################################################################################
//Koordinate
  var Storage_k = [
    [1329,943],
    [1342,930],
    [1471,930],
    [1514,973],
    [1514,1028],
    [1557,1028],
    [1557,979],
    [1586,979],
    [1586,850],
    [1553,850],
    [1553,780],
    [1586,780],
    [1586,757],
    [1553,757],
    [1553,687],
    [1586,687],
    [1586,633],
    [1466,633],
    [1466,610],
    [1630,436],
    [1801,436],
    [1965,610],
    [1965,633],
    [1842,633],
    [1842,687],
    [1868,687],
    [1868,757],
    [1842,757],
    [1842,780],
    [1868,780],
    [1868,850],
    [1842,850],
    [1842,979],
    [1873,979],
    [1873,1028],
    [2017,1028],
    [2017,1026],
    [2023,1026],
    [2023,1020],
    [2028,1020],
    [2028,1015],
    [2034,1015],
    [2034,1009],
    [2040,1009],
    [2040,1003],
    [2050,1003],
    [2050,1570],
    [1985,1570],
    [1985,1896],
    [2050,1896],
    [2050,2048],
    [1981,2048],
    [1981,2081],
    [1678,2081],
    [1655,2058],
    [1655,2022],
    [1619,2022],
    [1597,2000],
    [1597,1871],
    [1423,1871],
    [1387,1835],
    [1387,1083],
    [1355,1083],
    [1329,1057]
];
var Barracks_k = [
    [2124,1089],
    [2695,1089],
    [2695,1135],
    [2653,1135],
    [2653,1463],
    [2124,1463],
];
var Chapel_k = [
    [2344,755],
    [2405,755],
    [2405,650],
    [3145,650],
    [3145,456],
    [3404,456],
    [3404,650],
    [3446,650],
    [3446,800],
    [3571,800],
    [3571,985],
    [3446,985],
    [3446,1135],
    [3404,1135],
    [3404,1347],
    [3161,1347],
    [3161,936],
    [3071,936],
    [3071,1079],
    [2405,1079],
    [2405,986],
    [2344,986]
];
var Library_k = [
    [2705,1089],
    [3081,1089],
    [3081,946],
    [3151,946],
    [3151,1357],
    [3271,1357],
    [3271,1837],
    [3227,1837],
    [3172,1715],
    [3033,1659],
    [2894,1715],
    [2839,1853],
    [2895,1992],
    [2705,1992],
    [2705,1600],
    [2842,1600],
    [2842,1508],
    [2705,1508]
];
var Entrance_Hall_k = [
    [3281,1357],
    [3404,1357],
    [3404,1417],
    [3519,1417],
    [3519,1357],
    [4248,1357],
    [4248,1292],
    [4427,1292],
    [4427,1411],
    [4319,1411],
    [4319,1830],
    [4428,1830],
    [4428,1949],
    [4249,1949],
    [4249,1881],
    [3669,1881],
    [3598,1757],
    [3472,1757],
    [3472,1844],
    [3281,1844]
];
var Generator_k = [
    [2141,1738],
    [2213,1738],
    [2213,1672],
    [2695,1672],
    [2695,2002],
    [2906,2002],
    [3019,2047],
    [3019,2177],
    [2255,2177],
    [2213,2135],
    [2213,1979],
    [2141,1979]
];
var B7_k = [
    [2783,2235],
    [2841,2235],
    [2841,2187],
    [3029,2187],
    [3029,2047],
    [3171,1991],
    [3227,1847],
    [3271,1847],
    [3271,1854],
    [3482,1854],
    [3482,1767],
    [3592,1767],
    [3656,1878],
    [3656,1881],
    [3628,1881],
    [3628,2617],
    [3526,2617],
    [3488,2578],
    [3450,2617],
    [3336,2617],
    [3297,2578],
    [3232,2643],
    [2841,2643],
    [2841,2314],
    [2783,2314]
];
var Bastion_k = [
    [2908,2729],
    [3239,2729],
    [3239,3013],
    [3269,3013],
    [3269,3067],
    [3239,3067],
    [3239,3106],
    [3269,3106],
    [3269,3165],
    [3052,3165],
    [3052,3141],
    [2992,3082],
    [3021,3053],
    [2956,2988],
    [2927,3017],
    [2908,2998]
];
var Quire_k = [4125,2548];
var Bauxite_Mine_k = [
    [2674,2187],
    [2384,2187],
    [2264,2334],
    [2207,2341],
    [2129,2267],
    [2032,2295],
    [2022,2387],
    [1947,2411],
    [1879,2423],
    [1839,2346],
    [1730,2341],
    [1715,2443],
    [1772,2465],
    [1383,2465],
    [1383,2531],
    [1834,2530],
    [1834,2599],
    [1524,2599],
    [1524,2665],
    [1717,2665],
    [1642,2721],
    [1642,2829],
    [1755,2921],
    [1820,2934],
    [1921,2889],
    [1921,3165],
    [1987,3165],
    [1987,2847],
    [2055,2766],
    [2055,3165],
    [2121,3165],
    [2121,2768],
    [2189,2801],
    [2189,3165],
    [2255,3165],
    [2255,2778],
    [2294,2763],
    [2415,2763],
    [2415,2699],
    [2406,2642],
    [2437,2584],
    [2437,2532],
    [2408,2500],
    [2443,2437],
    [2571,2437],
    [2571,2810],
    [2300,2810],
    [2300,2876],
    [2571,2876],
    [2571,3117],
    [2637,3117],
    [2637,2876],
    [2760,2876],
    [2760,2810],
    [2637,2810],
    [2637,2383],
    [2456,2383],
    [2479,2318],
    [2545,2271],
    [2595,2242]
];
var Biodome_3_k = [3763,2248];
var Biodome_2_k = [3763,2031];
var Biodome_1_k = [3979,2031];
var Headquarters_k = [
    [3456,650],
    [3604,650],
    [3760,728],
    [3825,893],
    [3760,1057],
    [3604,1135],
    [3456,1135],
    [3456,995],
    [3581,995],
    [3581,790],
    [3456,790]
];
//############################################################################################################################################
//ostale pomoćne varijable
var obicanStyle = {
    weight: 1.5,
    color: 'orange',
    fillColor: ' #ffb843 ',
    fillOpacity: 0.17
};
var highlightStyle = {
    weight: 5,
    color: 'red',
    fillColor: ' #red ',
    fillOpacity: 0.50
};
var quireStyle = {
    weight: 1.5,
    color: 'orange',
    fillColor: ' #ffb843 ',
    fillOpacity: 0.17,
    radius: 294
};
var biodomeStyle = {
    weight: 1.5,
    color: 'orange',
    fillColor: ' #ffb843 ',
    fillOpacity: 0.17,
    radius: 94
};
var Relay_fluff = "<font size='3'><b>Retu ceb-6 Astropathic Relay</b></font><br><font color='#626567 '><i>The station was built sometime during the Age of "+
"Rebirth on a moon not much smaller than Holy Terra. The moon, Retu ceb-6, was and is an inhospitable place, however, its position in the galaxy is what "+
"matters to the Imperium: it allowed for the largest Relay to be built close to the Eye of Terror, a Relay with enough capacity to transmit messages directly "+
"to the Imperial Palace in case of unholy outpour. Indeed, during the first few millennia the station has received ample support in terms of manpower and "+
"supplies. So many have lived and died on that station, making sure that the news, warnings and calls for aid throughout the galaxy were properly interpreted "+
"and passed on. As time wore on, the High Lords of Terra realized that Retu ceb’s 4 planetary defence lasers won’t do - the moon was an invaluable strategic "+
"asset in the fight against Chaos and its potential was being wasted. The Imperium couldn’t properly garrison the desolate moon and so it turned its attention "+
"to this purpose.</i></font><br>"
var Headquarters_fluff = "<font size='3'><b>Headquarters</b></font><br><font color='#626567 '><i>A semicircular space packed with screens, dials and buttons of all shapes and sizes. The room is lined with a foot of glasscrete, "+
"allowing the occupants to survey the moon directly. Since it is designed to monitor and adjust the flow of fuel, oxygen and power throughout the station, "+
"the headquarters is a vital territory for anyone seeking power over the base.</i></font><br>";
var Chapel_fluff = "<font size='3'><b>Chapel</b></font><br><font color='#626567 '><i>A baroque monstrosity clad in marble, gold and wax, the chapel is undeniable proof that even in places consigned to oblivion humanity’s "+
"faith in the Emperor is indomitable. Filled with relics of bygone times and reminders of why they uphold the Imperial Creed, this is a place the citizens of "+
"the Relay frequent most.</i></font><br>";
var Library_fluff = "<font size='3'><b>Library</b></font><br><font color='#626567 '><i>Tome upon tome upon tome. Going back millennia, this collection contains millions of books, records and fragments pertaining to the history "+
"of the Relay and the surrounding sector. Due to this precarious accumulation, the library is a dangerous place to visit and is only ever occupied by servitors "+
"and lowly scribes.</i></font><br>";
var Barracks_fluff = "<font size='3'><b>Barracks</b></font><br><font color='#626567 '><i>The area where the 74 citizens of the Relay are housed. Far from luxurious accommodation, the relatively small building is crammed with "+
"just the necessary amenities, all communal. Centuries of neglect have left the site quite unsavoury and fecund, with all manner of vermin having found their "+
"home in the barracks as well.</i></font><br>";
var Storage_fluff = "<font size='3'><b>Storage</b></font><br><font color='#626567 '><i>Oddly, the largest space of the Relay is the old aircraft hangar carved deep in the rocks of the moon. The constant dust storms have buried "+
"the hanger long ago, its only use now is to house old machinery, fuel, rations and the bodies of generations past. There are many who have found good use of "+
"the junk stored and turned the old hanger into a small scale manufactorum.</i></font><br>";
var Entrance_Hall_fluff = "<font size='3'><b>Entrance Hall</b></font><br><font color='#626567 '><i>With a landing pad in front and gates big enough to let two dreadnoughts through, the entrance hall of the Relay seems quite incongruous "+
" with the rest of the base. The gap is being bridged by the evident dilapidation of the building. The long hall is lined with remembrances of its late superintendents, many of which are "+
"completely moth-eaten and tattered.</i></font><br>";
var Biodomes_fluff = "<font color='#626567 '><i>Three large geodesic domes with a plasteel armature and glasscrete panes are responsible for 70% of the Relay’s nutrition. The nearest "+
"star provides enough light for three species of plants to be successfully cultivated. The produce is not glamorous, consisting of algae wafers produced in large tanks, gantha-roots and "+
"marsh-rice. The rest of the foodstuffs have to be imported from far away.</i></font><br>";
var Quire_fluff = "<font size='3'><b>Quire</b></font><br><font color='#626567 '><i>The highest point of the base is the quire – a disc-like chamber perched on a sturdy pillar. To relay the message more securely, astropaths "+
"congregate and form a choir. This formation combines the power of each chorister and enables the message to travel through to warp faster. Quires are only found in Astropathic "+
"Relays that are of great importance to the Imperium.</i></font><br>";
var Bastion_fluff = "<font size='3'><b>Bastion</b></font><br><font color='#626567 '><i>One of four planetary defence lasers is situated on top of the bastion, surrounded by battlements on three sides. The small fortification "+
"alone is enough to hold small threats at bay, however, it provides a valuable strategic position for extraplanetary forces should greater threats emerge. The bastion also has a secure "+
"comms unit connected to every part of the Relay.</i></font><br>";
var BauxiteMine_fluff = "<font size='3'><b>Bauxite Mine</b></font><br><font color='#626567 '><i>The Imperium of Man can’t let anything go to waste. When the station was initially being constructed, the builders found rich deposits "+
"of bauxite right next to the building site. The export of the ore has since proven to be extremely difficult and has been stopped altogether. The only thing left in that millennia-old "+
"strip mine is faulty equipment, rusty rails, and red dust.</i></font><br>";
var B7_fluff = "<font size='3'><b>B7</b></font><br><font color='#626567 '><i>A junkyard, at least, has a purpose. The main function of sector B7 has long been forgotten, it is now a gaping void near the heart of the base. "+
"The high ceiling is supported by massive columns, which are the only thing that breaks its uniformity. At this point in history, the only use for it the astropaths have found is to "+
"house guests, who seldom visit the old Relay.</i></font><br>";
var Generator_fluff = "<font size='3'><b>Generator</b></font><br><font color='#626567 '><i>Whir, clang, buzz, hiss. The endless machinery hasn’t stopped for 10 thousand years. The generator is a soulless leviathan keeping "+
"the station alive. A leviathan of fuel, engine, rivet, and piston. The many towering furnaces, along with the acrid stench of burnt oil, make for a highly inhospitable facility that "+
"only servitors and hardened ogryns can maintain.</i></font><br>";


var battle = L.icon({
    iconUrl: 'battlebtd.png',
    iconSize:     [22, 22],
    iconAnchor:   [11, 11],
    popupAnchor:  [0, 0],
    indeks: 0
});
var battleAlt = L.icon({
    iconUrl: 'battlebthred.png',
    iconSize:     [22, 22],
    iconAnchor:   [11, 11],
    popupAnchor:  [0, 0],
    indeks: 1
});
var kommandos = L.icon({
    iconUrl: 'baxesbtd.png',
    iconSize:     [22, 20],
    iconAnchor:   [11, 10],
    popupAnchor:  [0, 0],
    indeks: 2
});
var kommandosAlt = L.icon({
    iconUrl: 'baxesbth.png',
    iconSize:     [22, 20],
    iconAnchor:   [11, 10],
    popupAnchor:  [0, 0],
    indeks: 3
});
var dguard = L.icon({
    iconUrl: 'dguardbtd.png',
    iconSize:     [14, 24],
    iconAnchor:   [7, 12],
    popupAnchor:  [0, 0],
    indeks: 4
});
var dguardAlt = L.icon({
    iconUrl: 'dguardbth.png',
    iconSize:     [14, 24],
    iconAnchor:   [7, 12],
    popupAnchor:  [0, 0],
    indeks: 5
});
var harlequins = L.icon({
    iconUrl: 'harlequinsbtd.png',
    iconSize:     [14, 26],
    iconAnchor:   [7, 13],
    popupAnchor:  [0, 0],
    indeks: 6
});
var harlequinsAlt = L.icon({
    iconUrl: 'harlequinsbth.png',
    iconSize:     [14, 26],
    iconAnchor:   [7, 13],
    popupAnchor:  [0, 0],
    indeks: 7
});
var heretic_astartes = L.icon({
    iconUrl: 'hastartesbtd.png',
    iconSize:     [24, 24],
    iconAnchor:   [12, 12],
    popupAnchor:  [0, 0],
    indeks: 8
});
var heretic_astartesAlt = L.icon({
    iconUrl: 'hastartesbth.png',
    iconSize:     [24, 24],
    iconAnchor:   [12, 12],
    popupAnchor:  [0, 0],
    indeks: 9
});
var kriegs = L.icon({
    iconUrl: 'kriegbtd.png',
    iconSize:     [22, 22],
    iconAnchor:   [11, 11],
    popupAnchor:  [0, 0],
    indeks: 10
});
var kriegsAlt = L.icon({
    iconUrl: 'kriegbth.png',
    iconSize:     [22, 22],
    iconAnchor:   [11, 11],
    popupAnchor:  [0, 0],
    indeks: 11
});
var metalica = L.icon({
    iconUrl: 'metalicabtd.png',
    iconSize:     [22, 20],
    iconAnchor:   [11, 10],
    popupAnchor:  [0, 0],
    indeks: 12
});
var metalicaAlt = L.icon({
    iconUrl: 'metalicabth.png',
    iconSize:     [22, 20],
    iconAnchor:   [11, 10],
    popupAnchor:  [0, 0],
    indeks: 13
});
var rtraders = L.icon({
    iconUrl: 'rtradersbtd.png',
    iconSize:     [22, 22],
    iconAnchor:   [11, 11],
    popupAnchor:  [0, 0],
    indeks: 14
});
var rtradersAlt = L.icon({
    iconUrl: 'rtradersbth.png',
    iconSize:     [22, 22],
    iconAnchor:   [11, 11],
    popupAnchor:  [0, 0],
    indeks: 15
});
var genestealers = L.icon({
    iconUrl: 'rclawbtd.png',
    iconSize:     [18, 22],
    iconAnchor:   [9, 11],
    popupAnchor:  [0, 0],
    indeks: 16
});
var genestealersAlt = L.icon({
    iconUrl: 'rclawbth.png',
    iconSize:     [18, 22],
    iconAnchor:   [9, 11],
    popupAnchor:  [0, 0],
    indeks: 17
});


//############################################################################################################################################
//Session 0

var Storage_0 = L.polygon(Storage_k, obicanStyle);
Storage_0.bindTooltip(Storage_fluff + "<b>Assets:</b> Expanded Armoury, Surveillance System, Engineering Bay</b><br><b>Resources:</b> 2 RP, 4 (5EXP), 4 Rare equipment, 3 Base slot",{direction:"center"});

var Barracks_0 = L.polygon(Barracks_k, obicanStyle);
Barracks_0.bindTooltip(Barracks_fluff + "<b>Resources:</b> 2 RP, 2 (5EXP), 5 Rare equipment",{direction:"center"});

var Chapel_0 = L.polygon(Chapel_k, obicanStyle);
Chapel_0.bindTooltip(Chapel_fluff + "<b>Assets:</b> War Shrine, Comms Network<br><b>Resources:</b> 2 RP, 4 (5EXP), 3 Base slot",{direction:"center"});

var Library_0 = L.polygon(Library_k, obicanStyle);
Library_0.bindTooltip(Library_fluff + "<b>Assets:</b> Med Bay, Intelligence Network</b><br><b>Resources:</b> 2 RP, 5 (EXP), 2 Base slot",{direction:"center"});

var Entrance_Hall_0 = L.polygon(Entrance_Hall_k, obicanStyle);
Entrance_Hall_0.bindTooltip(Entrance_Hall_fluff +"<b>Resources:</b> 2 RP, 5 (5EXP)",{direction:"center"});

var Generator_0 = L.polygon(Generator_k, obicanStyle);
Generator_0.bindTooltip(Generator_fluff+"<b>Resources:</b> 3 RP, 4 Base slot",{direction:"center"})

var B7_0 = L.polygon(B7_k, obicanStyle);
B7_0.bindTooltip(B7_fluff+"<b>Resources:</b> 3 RP, 2 (5EXP)",{direction:"center"});

var Bastion_0 = L.polygon(Bastion_k, obicanStyle);
Bastion_0.bindTooltip(Bastion_fluff+"<b>Assets:</b> Comms Network<br><b>Resources:</b> 2 RP, 3 (5EXP), 4 Rare equipment",{direction:"center"});

var Quire_0 = L.circle(Quire_k, quireStyle);
Quire_0.bindTooltip(Quire_fluff+"<b>Assets:</b> Intelligence Network, Tactical Uplink<br><b>Resources:</b> 2 RP, 4 (5EXP), 3 Base slot",{direction:"center"});

var Bauxite_Mine_0 = L.polygon(Bauxite_Mine_k, obicanStyle);
Bauxite_Mine_0.bindTooltip(BauxiteMine_fluff+"<b>Assets:</b> Stimm Stash<br><b>Resources:</b> 2 RP, 5 Rare equipment",{direction:"center"});

var Biodome_3_0 = L.circle(Biodome_3_k, biodomeStyle);
Biodome_3_0.bindTooltip("<font size='3'><b>Biodome 3</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});
var Biodome_2_0 = L.circle(Biodome_2_k, biodomeStyle);
Biodome_2_0.bindTooltip("<font size='3'><b>Biodome 2</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});
var Biodome_1_0 = L.circle(Biodome_1_k, biodomeStyle);
Biodome_1_0.bindTooltip("<font size='3'><b>Biodome 1</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});

var Headquarters_0 = L.polygon(Headquarters_k, obicanStyle);
Headquarters_0.bindTooltip(Headquarters_fluff + "<b>Assets:</b> Surveillance System<br><b>Resources:</b> 4 (5EXP), 3 Rare equipment, 2 Base slot",{direction:"center"});

var teritoriji_0 = L.layerGroup([Storage_0, Barracks_0, Chapel_0, Library_0, Entrance_Hall_0, Generator_0, B7_0, Bastion_0, Quire_0, Bauxite_Mine_0, Biodome_1_0, Biodome_2_0, Biodome_3_0, Headquarters_0]);
var teritoriji_0_array = [Storage_0, Barracks_0, Chapel_0, Library_0, Entrance_Hall_0, Generator_0, B7_0, Bastion_0, Quire_0, Bauxite_Mine_0, Biodome_1_0, Biodome_2_0, Biodome_3_0, Headquarters_0];
//############################################################################################################################################
//Session 1

var Storage_1 = L.polygon(Storage_k, obicanStyle);
Storage_1.bindTooltip(Storage_fluff + "<b>Assets:</b> Expanded Armoury, Surveillance System, Engineering Bay</b><br><b>Resources:</b> 2 RP, 4 (5EXP), 4 Rare equipment, 3 Base slot",{direction:"center"});

var Barracks_1 = L.polygon(Barracks_k, obicanStyle);
Barracks_1.bindTooltip(Barracks_fluff + "<b>Resources:</b> 2 RP, 1 (5EXP), 4 Rare equipment",{direction:"center"});

var Chapel_1 = L.polygon(Chapel_k, obicanStyle);
Chapel_1.bindTooltip(Chapel_fluff + "<b>Assets:</b> War Shrine, Comms Network<br><b>Resources:</b> 2 RP, 3 (5EXP), 2 Base slot",{direction:"center"});

var Library_1 = L.polygon(Library_k, obicanStyle);
Library_1.bindTooltip(Library_fluff + "<b>Assets:</b> Med Bay, Intelligence Network</b><br><b>Resources:</b> 2 RP, 5 (EXP), 2 Base slot",{direction:"center"});

var Entrance_Hall_1 = L.polygon(Entrance_Hall_k, obicanStyle);
Entrance_Hall_1.bindTooltip(Entrance_Hall_fluff +"<b>Resources:</b> 2 RP, 5 (5EXP)",{direction:"center"});

var Generator_1 = L.polygon(Generator_k, obicanStyle);
Generator_1.bindTooltip(Generator_fluff+"<b>Resources:</b> 3 RP, 4 Base slot",{direction:"center"})

var B7_1 = L.polygon(B7_k, obicanStyle);
B7_1.bindTooltip(B7_fluff+"<b>Resources:</b> 3 RP, 2 (5EXP)",{direction:"center"});

var Bastion_1 = L.polygon(Bastion_k, obicanStyle);
Bastion_1.bindTooltip(Bastion_fluff+"<b>Assets:</b> Comms Network<br><b>Resources:</b> 2 RP, 3 (5EXP), 4 Rare equipment",{direction:"center"});

var Quire_1 = L.circle(Quire_k, quireStyle);
Quire_1.bindTooltip(Quire_fluff+"<b>Assets:</b> Intelligence Network, Tactical Uplink<br><b>Resources:</b> 2 RP, 2 (5EXP), 3 Base slot",{direction:"center"});

var Bauxite_Mine_1 = L.polygon(Bauxite_Mine_k, obicanStyle);
Bauxite_Mine_1.bindTooltip(BauxiteMine_fluff+"<b>Assets:</b> Stimm Stash<br><b>Resources:</b> 2 RP, 5 Rare equipment",{direction:"center"});

var Biodome_3_1 = L.circle(Biodome_3_k, biodomeStyle);
Biodome_3_1.bindTooltip("<font size='3'><b>Biodome 3</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});
var Biodome_2_1 = L.circle(Biodome_2_k, biodomeStyle);
Biodome_2_1.bindTooltip("<font size='3'><b>Biodome 2</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});
var Biodome_1_1 = L.circle(Biodome_1_k, biodomeStyle);
Biodome_1_1.bindTooltip("<font size='3'><b>Biodome 1</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});

var Headquarters_1 = L.polygon(Headquarters_k, obicanStyle);
Headquarters_1.bindTooltip(Headquarters_fluff + "<b>Assets:</b> Surveillance System<br><b>Resources:</b> 4 (5EXP), 3 Rare equipment, 2 Base slot",{direction:"center"});

var teritoriji_1 = L.layerGroup([Storage_1, Barracks_1, Chapel_1, Library_1, Entrance_Hall_1, Generator_1, B7_1, Bastion_1, Quire_1, Bauxite_Mine_1, Biodome_1_1, Biodome_2_1, Biodome_3_1, Headquarters_1]);
var teritoriji_1_array = [Storage_1, Barracks_1, Chapel_1, Library_1, Entrance_Hall_1, Generator_1, B7_1, Bastion_1, Quire_1, Bauxite_Mine_1, Biodome_1_1, Biodome_2_1, Biodome_3_1, Headquarters_1];


battle_1_1 = L.marker([3000, 1500], {icon: battle});
battle_1_1.bindTooltip("<font size='3'><b>First contact in the Relay</b></font><br>"+
"<font color='#626567 '><i>Shots were fired, grenades were launched, books were read...</i></font><br>"+
"<b>Opposing teams: </b><br>"+
"<span class='above'>The B'aiq's Bazaar Bunch<span class='below'>(10 VP)</span></span> <span class='b'> vs.</span>"+
"<span class='above'>The Haar<span class='below'>(12 VP)</span></span> <span class='b'>vs.</span>"+
"<span class='above'>The Newseam Rattlesnakes<span class='below'>(4 VP)</span></span><br>"+
"<b>Casualties: </b><br>"+
"The Newseam Rattlesnakes:<br> - Obed Peck (Cerebral affliction)<br> - Bugs Lobe (Cerebral Affliction)<br><br>"+
"<center><img src=first_contact_pic.jpg height='303' width='225' style='opacity:0.8'></center>");
battle_1_1.addTo(teritoriji_1);
battle_1_1.off();

harlequins_1 = L.marker([2350, 1300], {icon: harlequins});
harlequins_1.addTo(teritoriji_1);
heretic_astartes_1 = L.marker([3300, 1000], {icon: heretic_astartes});
heretic_astartes_1.addTo(teritoriji_1);
genestealers_1 = L.marker([4150, 2500], {icon: genestealers});
genestealers_1.addTo(teritoriji_1);

//############################################################################################################################################
//Session 2

var Storage_2 = L.polygon(Storage_k, obicanStyle);
Storage_2.bindTooltip(Storage_fluff + "<b>Assets:</b> Expanded Armoury, Surveillance System, Engineering Bay</b><br><b>Resources:</b> 2 RP, 4 (5EXP), 3 Rare equipment, 3 Base slot",{direction:"center"});

var Barracks_2 = L.polygon(Barracks_k, obicanStyle);
Barracks_2.bindTooltip(Barracks_fluff + "<b>Resources:</b> 2 RP, 1 (5EXP), 4 Rare equipment",{direction:"center"});

var Chapel_2 = L.polygon(Chapel_k, obicanStyle);
Chapel_2.bindTooltip(Chapel_fluff + "<b>Assets:</b> War Shrine, Comms Network<br><b>Resources:</b> 2 RP, 2 (5EXP), 2 Base slot",{direction:"center"});

var Library_2 = L.polygon(Library_k, obicanStyle);
Library_2.bindTooltip(Library_fluff + "<b>Assets:</b> Med Bay, Intelligence Network</b><br><b>Resources:</b> 2 RP, 5 (EXP), 2 Base slot",{direction:"center"});

var Entrance_Hall_2 = L.polygon(Entrance_Hall_k, obicanStyle);
Entrance_Hall_2.bindTooltip(Entrance_Hall_fluff +"<b>Resources:</b> 3 (5EXP)",{direction:"center"});

var Generator_2 = L.polygon(Generator_k, obicanStyle);
Generator_2.bindTooltip(Generator_fluff+"<b>Resources:</b> 3 RP, 3 Base slot",{direction:"center"})

var B7_2 = L.polygon(B7_k, obicanStyle);
B7_2.bindTooltip(B7_fluff+"<b>Resources:</b> 3 RP, 1 (5EXP)",{direction:"center"});

var Bastion_2 = L.polygon(Bastion_k, obicanStyle);
Bastion_2.bindTooltip(Bastion_fluff+"<b>Assets:</b> Comms Network<br><b>Resources:</b> 2 RP, 2 (5EXP), 4 Rare equipment",{direction:"center"});

var Quire_2 = L.circle(Quire_k, quireStyle);
Quire_2.bindTooltip(Quire_fluff+"<b>Assets:</b> Intelligence Network, Tactical Uplink<br><b>Resources:</b> 2 RP, 2 (5EXP), 3 Base slot",{direction:"center"});

var Bauxite_Mine_2 = L.polygon(Bauxite_Mine_k, obicanStyle);
Bauxite_Mine_2.bindTooltip(BauxiteMine_fluff+"<b>Assets:</b> Stimm Stash<br><b>Resources:</b> 2 RP, 5 Rare equipment",{direction:"center"});

var Biodome_3_2 = L.circle(Biodome_3_k, biodomeStyle);
Biodome_3_2.bindTooltip("<font size='3'><b>Biodome 3</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});
var Biodome_2_2 = L.circle(Biodome_2_k, biodomeStyle);
Biodome_2_2.bindTooltip("<font size='3'><b>Biodome 2</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});
var Biodome_1_2 = L.circle(Biodome_1_k, biodomeStyle);
Biodome_1_2.bindTooltip("<font size='3'><b>Biodome 1</b></font><br>"+Biodomes_fluff+"<b>Resources:</b> 2RP, 3 (5EXP), 2 Rare equipment",{direction:"center"});

var Headquarters_2 = L.polygon(Headquarters_k, obicanStyle);
Headquarters_2.bindTooltip(Headquarters_fluff + "<b>Assets:</b> Surveillance System<br><b>Resources:</b> 4 (5EXP), 2 Rare equipment, 2 Base slot",{direction:"center"});

var teritoriji_2 = L.layerGroup([Storage_2, Barracks_2, Chapel_2, Library_2, Entrance_Hall_2, Generator_2, B7_2, Bastion_2, Quire_2, Bauxite_Mine_2, Biodome_1_2, Biodome_2_2, Biodome_3_2, Headquarters_2]);
var teritoriji_2_array = [Storage_2, Barracks_2, Chapel_2, Library_2, Entrance_Hall_2, Generator_2, B7_2, Bastion_2, Quire_2, Bauxite_Mine_2, Biodome_1_2, Biodome_2_2, Biodome_3_2, Headquarters_2];


battle_1_2 = L.marker([3700, 895], {icon: battle});
battle_1_2.bindTooltip("<font size='3'><b>Bridgeburners' Recon Disaster</b></font><br>" + 
"<font color='#626567 '><i>At 9:14, Terran time, contact was reestablished with the Bridgeburners recon squad, whereupon sergeant Whiskeyjack explained that they encountered Aeldari, of particular tactical mobility, and were forced to retreat. Notably, the sergeant refused to make any further comments.</i></font><br>"+
"<b>Opposing teams: </b><br>"+
"<span class='above'>The B'aiq's Bazaar<span class='below'>(9 VP)</span></span> <span class='b'> vs.</span>"+
"<span class='above'>The Bridgeburners<span class='below'>(1 VP)</span></span><br>"+
"<b>Casualties: </b><br>"+
"None<br><br>" +
"<center><img src=hq_pic.jpg height='200' width='320' style='opacity:0.8'></center>");
battle_1_2.addTo(teritoriji_2);
battle_1_2.off();

battle_2_2 = L.marker([3763,2248], {icon: battle});
battle_2_2.bindTooltip("<font size='3'><b>Blood in the Wafers</b></font><br>"+
"<font color='#626567 '><i>The Newseam Rattlesnakes and the Haar catch eachother unawares in the marsh rice biodome, with the Rattlesnakes ultimately succumbing to the tide of malice, forcing a retreat.</i></font><br>"+
"<b>Opposing teams: </b><br>"+
"<span class='above'>The Haar<span class='below'>(10 VP)</span></span> <span class='b'> vs.</span>"+
"<span class='above'>The Newseam Rattlesnakes<span class='below'>(8 VP)</span></span><br>"+
"<b>Casualties: </b><br>"+
"The Newseam Rattlesnakes:<br> - Malcolm Eages (Sapped Strength)<br> - Ghaster Eliot (Sapped Strength)<br>" +
"The Haar:<br> - Tirros, the Blaze (Sapped Strength)<br><br>"+
"<center><img src=wafers_pic.jpeg height='240' width='320' style='opacity:0.8'></center>");
battle_2_2.addTo(teritoriji_2);
battle_2_2.off();

battle_3_2 = L.marker([2500, 1900], {icon: battle});
battle_3_2.bindTooltip("<font size='3'><b>It Has No Mouth, yet It Must Scream</b></font><br>"+
"<font color='#626567 '><i>Our squadron of The White Hunters, ever the tinkerers, made their way towards the Generator room: seeking potential advantage over the other teams by controlling the station's power supply. There they encountered the most unlikely creatures, the greenskins of Gork's Blokes; who took a very different form of fascination with the technology. Loudness ensued, and much of what was even left of the room's abandoned instruments was rendered unoperable during the engagement.</i></font><br>"+
"<b>Opposing teams: </b><br>"+
"<span class='above'>The Gork's Blokes<span class='below'>(16 VP)</span></span> <span class='b'> vs.</span>"+
"<span class='above'>The White Hunters<span class='below'>(7 VP)</span></span><br>"+
"<b>Casualties: </b><br>The Gork's Blokes:<br> - TBA (Cerebral Affliction)");
battle_3_2.addTo(teritoriji_2);
battle_3_2.off();

battle_4_2 = L.marker([3800, 1650], {icon: battle});
battle_4_2.bindTooltip("<font size='3'><b>The Entrance Hall Thunderdome</b></font><br>"+
"<font color='#626567 '><i>Surprised at the remaining combat readiness of the Bridgeburners, the B'aiq's Bazaar chased the retreating guardsmen into the Entrance Hall, attempting to cut them off. What surprised even the Harlequin troupe was that the nearby squadron of The White Hunters and the team of Newseam Rattlesnakes were already in a standoff at the exact location of the ambush. Some would appreciate the irony of the teams receiving their baptism of fire at the very entry point of the complex. Khorne did laugh.</i></font><br>"+
"<b>Opposing teams: </b><br>"+
"<span class='above'>The B'aiq's Bazaar<span class='below'>(5 VP)</span></span> <span class='b'> vs.</span>"+
"<span class='above'>The Bridgeburners<span class='below'>(10 VP)</span></span> <span class='b'> vs.</span>"+
"<span class='above'>The White Hunters<span class='below'>(0 VP)</span></span> <span class='b'> vs.</span>"+
"<span class='above'>The Newseam Rattlesnakes<span class='below'>(8 VP)</span></span><br>"+
"<b>Casualties: </b><br>"+
"The Newseam Rattlesnakes:<br> - Gorge la Forge (Severe Concussion)<br>"+
"The White Hunters:<br> - Strigidae_17 (Cerebral Affliction)<br> - JU_BO_55 (Sapped Strength)<br> - JU_BO_63 (Lingering Ailment)<br><br>"+
"<center><img src=4_pic.jpeg height='220' width='350' style='opacity:0.8'></center>");
battle_4_2.addTo(teritoriji_2);
battle_4_2.off();

kommandos_2 = L.marker([1700, 1100], {icon: kommandos});
kommandos_2.addTo(teritoriji_2);
harlequins_2 = L.marker([3800, 1800], {icon: harlequins});
harlequins_2.addTo(teritoriji_2);
heretic_astartes_2 = L.marker([3200, 2300], {icon: heretic_astartes});
heretic_astartes_2.addTo(teritoriji_2);
kriegs_2 = L.marker([3450, 1650], {icon: kriegs});
kriegs_2.addTo(teritoriji_2);
metalica_2 = L.marker([3800, 1460], {icon: metalica});
metalica_2.addTo(teritoriji_2);
genestealers_2 = L.marker([4150, 1650], {icon: genestealers});
genestealers_2.addTo(teritoriji_2);

//############################################################################################################################################
//liste
var sviTeritoriji = [teritoriji_0_array, teritoriji_1_array, teritoriji_2_array];
var sveIkone = [battle, battleAlt, kommandos, kommandosAlt, dguard, dguardAlt, harlequins, harlequinsAlt, heretic_astartes, heretic_astartesAlt, kriegs, kriegsAlt, metalica, metalicaAlt, rtraders, rtradersAlt, genestealers, genestealersAlt];
var sviMarkeri = [
    battle_1_1, harlequins_1, heretic_astartes_1, genestealers_1, 
    battle_1_2, battle_2_2, battle_3_2, battle_4_2, kommandos_2, harlequins_2, heretic_astartes_2, kriegs_2, metalica_2, genestealers_2];
var sveIkoneSize = [];
for(var i=0; i<sveIkone.length ;i++){
    sveIkoneSize.push(sveIkone[i].options.iconSize);
}
var sveIkoneAnchor = [];
for(var i=0; i<sveIkone.length ;i++){
    sveIkoneAnchor.push(sveIkone[i].options.iconAnchor);
}

var rankovi = ["Adept", "Veteran", "Ace", "Grizzled", "Revered"];
var scars = ["Slain", "Critical Impairment", "Severe Concussion", "Sapped Strength", "Lingering Ailment", "Cerebral Affliction"];
var specialisms = ["Combat", "Staunch", "Marksman", "Scout"];
var sviKommando = [
    ["Bossman",[0,2,-1,-1,-1],[[],[],[],[],[],[]],2,"boss nob"],
    ["Iron'ed",[0,2,-1,-1,-1],[[],[],[],[],[],[]],1,"breacha"],
    ["Krug'ah",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"slasha"],
    ["TBA",[0,2,-1,-1,-1],[[],[],[],[],[],[]],1,"snipa"],
    ["TBA",[0,-1,-1,-1,-1],[[],[],[],[],[],[2]],3,"dakka"],
    ["TBA",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],3,"comms"],
    ["Cooka",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],4,"burna"],
    ["TBA",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],2,"rokkit"],
    ["Jeff",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],3,"choppa"],
    ["TBA",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],2,"grot"],
    ["Lolita",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"bomb squig"]
];
var sviDGuard= [["testni1",[0,1,2,-1,-1],[[1],[1],[1],[],[],[]],1],["testni2",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1],["testni3",[0,1,-1,-1,-1],[[],[],[],[],[],[]],1]];
var sviHarlequin = [
    ["B'aiq the Liar",[0,1,-1,-1,-1],[[],[],[],[],[],[]],1,"lead player"],
    ["Mog Flexfiend",[0,1,-1,-1,-1],[[],[],[],[],[],[]],4,"shadowseer"],
    ["Kitten Whiskers",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"death jester"],
    ["Mischiev&eacute",[0,1,-1,-1,-1],[[],[],[],[],[],[]],3,"neuro disruptor"],
    ["Prince Calisthenic",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"fusion pistol"],
    ["Beaky Cilliana",[0,1,2,-1,-1],[[],[],[],[],[],[]],1,"kiss"],
    ["Biara Fly",[0,1,-1,-1,-1],[[],[],[],[],[],[]],1,"kiss"],
    ["The Fooler",[0,1,-1,-1,-1],[[],[],[],[],[],[]],1,"caress"]
];
var sviHAstartes = [
    ["Zarrah, the Flayer",[0,1,2,-1,-1],[[],[],[],[],[],[]],1,"chosen"],
    ["Tarran, the Silence",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"aspiring champion"],
    ["Karrva, the Maw",[0,1,-1,-1,-1],[[],[],[],[],[],[]],1,"anointed"],
    ["Orran, the Siren",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"butcher"],
    ["Tirros, the Blaze",[0,1,-1,-1,-1],[[],[],[],[2],[],[]],3,"acolyte"],
    ["Saref, the Blade",[0,1,2,-1,-1],[[],[],[],[],[],[]],3,"plasma gun"],
    ["Toqrrion, the Devourer",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],4,"meltagun"],
    ["Barran, the Beast",[0,1,-1,-1,-1],[[],[],[],[],[],[]],2,"heavy bolter"],
    ["Norrevan, the Torrent",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],3,"missile launcher"],
    ["Virrsmo, the Duality",[0,2,-1,-1,-1],[[],[],[],[],[],[]],2,"boltgun icon bearer"],
    ["Virrsmo, the Duality",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"chainsword icon bearer"]
];
var sviKrieg = [
    ["Whiskeyjack",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"sergeant"],
    ["Kalam",[0,2,-1,-1,-1],[[],[],[],[],[],[]],1,"confidant"],
    ["Mallet",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"medic"],
    ["Quick Ben",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"comms"],
    ["Fiddler",[0,2,-1,-1,-1],[[],[],[],[],[],[]],4,"demolition"],
    ["Sorry",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"sniper"],
    ["Hedge",[0,2,-1,-1,-1],[[],[],[],[],[],[]],4,"spotter"],
    ["Trotts",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"meltagun"],
    ["Aimless",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"plasma gun"],
    ["Shank",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"grenade launcher"],
    ["Ferret",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"lasgun"],
    ["Dasalle",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"lasgun"],
    ["Runter",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"lasgun"],
    ["Story",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"lasgun"]
];
var sviMetalica = [
    ["Aquilla_06",[0,2,-1,-1,-1],[[],[],[],[],[],[]],1,"ruststalker princeps"],
    ["JU_ZP_56",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"ranger alpha"],
    ["Accipiter_19",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1, "transonic blades"],
    ["Circinae_06",[0,2,-1,-1,-1],[[],[],[],[],[],[]],4, "cordclaw"],
    ["Strigidae_17",[0,2,-1,-1,-1],[[],[],[],[],[],[2]],1,"transonic blades"],
    ["Cariamidae_13",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"transonic blades"],
    ["JU_AR_39",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"plasma caliver"],
    ["JU_AR_39",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1,"arc rifle"],
    ["JU_GE_07",[0,2,-1,-1,-1],[[],[],[],[],[],[]],4,"surveyor"],
    ["JU_BO_32",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"galvanic rifle"],
    ["JU_BO_55",[0,-1,-1,-1,-1],[[],[],[],[2],[],[]],1,"galvanic rifle"],
    ["JU_BO_63",[0,-1,-1,-1,-1],[[],[],[],[],[2],[]],1, "galvanic rifle"],
    ["JU_BO_46",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3, "galvanic rifle"],
    ["JU_BO_29",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1, "galvanic rifle"]
];
var sviRtrader = [["testni1",[0,1,2,-1,-1],[[1],[1],[1],[],[],[]],1],["testni2",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],1],["testni3",[0,1,-1,-1,-1],[[],[],[],[],[],[]],1]];
var sviRClaw = [
    ["Amos Marsh",[0,2,-1,-1,-1],[[],[],[],[],[],[]],1,"leader"],
    ["Gobb Pyle",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"heavy stubber"],
    ["Gorge la Forge",[0,1,-1,-1,-1],[[],[],[2],[],[],[2]],2,"seismic cannon"],
    ["Jed Black",[0,1,-1,-1,-1],[[],[],[],[],[],[]],4,"flamer"],
    ["Jayne Shea",[0,1,-1,-1,-1],[[],[],[],[],[],[]],3,"kelermorph"],
    ["Childe",[0,1,-1,-1,-1],[[],[],[],[],[],[]],1,"locust"],
    ["Zadok Alun",[0,-1,-1,-1,-1],[[],[],[],[],[],[]],0,"icon bearer"],
    ["Obed Peck",[0,-1,-1,-1,-1],[[],[],[],[],[],[1,2]],0,"shotgun"],
    ["Sultan Frye",[0,2,-1,-1,-1],[[],[],[],[],[],[]],3,"grenade launcher"],
    ["Malcolm Eages",[0,-1,-1,-1,-1],[[],[],[],[2],[],[]],0,"shotgun"],
    ["Bugs Lobe",[0,-1,-1,-1,-1],[[],[],[],[],[],[1]],0,"shotgun"],
    ["Ghaster Eliot",[0,-1,-1,-1,-1],[[],[],[],[2],[],[]],0,"autogun"]
];
var sviTimovi = [sviKommando, sviDGuard, sviHarlequin, sviHAstartes, sviKrieg, sviMetalica, sviRtrader, sviRClaw];
var teamFluff =[
    "<center><img src=baxesbt.png height='72' width='79'></center><br><center><font size='3'><b>Gork's Blokes</b></font></center><br>",
    "<center><img src=dguardbt.png height='72' width='72'></center><br><br><center><font size='3'><b>Dguard ime</b></font></center><br>",
    "<center><img src=harlequinsbt.png height='96' width='52'></center><br><center><font size='3'><b>B'aiq's Bazaar</b></font></center><br>",
    "<center><img src=hastartesbt.png height='88' width='88'></center><br><center><font size='3'><b>Haar</b></font></center><br>",
    "<center><img src=kriegbt.png height='75' width='79'></center><br><center><font size='3'><b>Bridgeburners</b></font></center><br>",
    "<center><img src=metalicabt.png height='64' width='72'></center><br><center><font size='3'><b>Squadron 11628747 - &quotWhite Hunters&quot</b></font></center><br>",
    "<center><img src=rtradersbt.png height='52' width='104'></center><br><center><font size='3'><b>Rtrader ime</b></font></center><br>",
    "<center><img src=rclawbt.png height='80' width='61'></center><br><center><font size='3'><b>Newseam Rattlesnakes</b></font></center><br>"
];
//############################################################################################################################################
var nis_lol = L.layerGroup([]).addTo(map);
var baseMaps = {
    "Detaljna mapa": detaljna_mapa,
};
var overlayMaps = {
    "<span style='color: orange'><font size='3'>Without overlay</font></span>": nis_lol,
    "<span style='color: orange'><font size='3'>Starting state</font></span>": teritoriji_0,
    "<span style='color: orange'><font size='3'>Session 1</font></span>": teritoriji_1,
    "<span style='color: orange'><font size='3'>Session 2</font></span>": teritoriji_2
};
var layerControl = L.control.layers(overlayMaps,null, {collapsed:false}).addTo(map);
var legend = L.control({position: 'topright'});
legend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'info legend')
        div.innerHTML += "<center><img src=baxesbt.png height='54' width='59'></center><br>";
        div.innerHTML += "<center><img src=dguardbt.png height='54' width='54'></center><br>";
        div.innerHTML += "<center><img src=harlequinsbt.png height='71' width='37'></center><br>";
        div.innerHTML += "<center><img src=hastartesbt.png height='66' width='66'></center><br>";
        div.innerHTML += "<center><img src=kriegbt.png height='57' width='60'></center><br>";
        div.innerHTML += "<center><img src=metalicabt.png height='47' width='55'></center><br>";
        div.innerHTML += "<center><img src=rtradersbt.png height='38' width='78'></center><br>";
        div.innerHTML += "<center><img src=rclawbt.png height='59' width='46'></center><br>";
    return div;
};
legend.addTo(map);
var info = L.control({position:'topleft', opacity: 1});
info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info');
    this.update();
    return this._div;
};
info.update = function (props) {
    this._div.innerHTML = props;
};
info.addTo(map);
info.update(Relay_fluff);

html_imeLika = null;
html_rank = null;
rankIND = null;
html_specialism = null;
html_scars = null;
html_opis = null;
function iscitaj(i,j) {
    html_vraceni = "";
    html_vraceni += "<p align='left'>";
    for(var k = 0; k < sviTimovi[i].length; k++) {
        html_imeLika = sviTimovi[i][k][0];
        rankIND = sviTimovi[i][k][1].findLastIndex(vrijednost => vrijednost <= j && vrijednost != -1);
        html_rank = rankovi[rankIND];
        html_scars = "";
        html_opis = sviTimovi[i][k][4];
        for(n=0; n<6;n++){
            if (sviTimovi[i][k][2][n].filter(vrijednost => vrijednost <= j).length % 2 == 1) {
                html_scars += scars[n] + ", ";
            }
        }
        if (html_scars != "") {html_scars = "<font color='#626567 '><i>" + html_scars.slice(0,-2) + "</i></font>"}
        html_specialism = sviTimovi[i][k][3];

        html_vraceni += "<b>" + html_imeLika + " (" + html_opis + ")</b> - " + (rankIND ? specialisms[html_specialism-1]+" " : "") + html_rank + (html_scars=="" ? "" : " - " + html_scars) +"<br>";
    }
    html_vraceni += "</p>";
    return html_vraceni;
}

function alt(indekss) {
    if(indekss % 2 == 0) {return indekss +1;}
    return indekss - 1;
}

var selectedL = null;
var indeksTemp = 0;
function highlightLayer(e) {
    var layer = e.target;
    layer.closeTooltip();
    if (selectedL == null){
        if(layer instanceof L.Polygon || layer instanceof L.Circle){
            layer.setStyle(highlightStyle)
            layer.bringToFront();
            info.update(layer.getTooltip().getContent());
        }
        if (layer instanceof L.Marker){
            indeksTemp = layer.getIcon().options.indeks;
            layer.setIcon(sveIkone[alt(indeksTemp)]);
            if(indeksTemp > 1) {
                info.update(teamFluff[indeksTemp/2-1] + iscitaj(indeksTemp/2-1, CILayera));
            }
            else {
                info.update(layer.getTooltip().getContent());
            }
        }
    }
}
//"<center><img src=first_contact_pic.jpg height='405' width='300'></center><br>"
function resetLayer(e) {
    var layer = e.target;
    if (selectedL == null){
        if(layer instanceof L.Polygon || layer instanceof L.Circle){
            layer.setStyle(obicanStyle);
        }
        if (layer instanceof L.Marker && layer.getIcon().options.indeks%2 == 1){
            layer.setIcon(sveIkone[alt(layer.getIcon().options.indeks)]);
        }
        info.update(Relay_fluff);
    }
}
function clickLayer(e) {
    L.DomEvent.stopPropagation(e);
    var layer = e.target;
    layer.closeTooltip();
    if(selectedL instanceof L.Polygon || selectedL instanceof L.Circle){
        selectedL.setStyle(obicanStyle);
    }
    if(selectedL instanceof L.Marker){
        selectedL.setIcon(sveIkone[alt(selectedL.getIcon().options.indeks)]);
    }
    if(selectedL == layer){
        info.update(Relay_fluff);
        selectedL = null;
        return;
    }
    if (layer instanceof L.Polygon || layer instanceof L.Circle){
        layer.setStyle(highlightStyle);
        layer.bringToFront();
        info.update(layer.getTooltip().getContent()); 
    }
    if (layer instanceof L.Marker && layer.getIcon().options.indeks%2 == 0){
        indeksTemp = layer.getIcon().options.indeks;
        layer.setIcon(sveIkone[alt(indeksTemp)]);
        if(indeksTemp > 1) {
            info.update(teamFluff[indeksTemp/2-1] + iscitaj(indeksTemp/2-1, CILayera));
        }
        else {
            info.update(layer.getTooltip().getContent());
        }
    }
    selectedL = layer;  
}
function mapClick(e) {
    if(selectedL instanceof L.Polygon || selectedL instanceof L.Circle){selectedL.setStyle(obicanStyle)};
    if(selectedL instanceof L.Marker){
        selectedL.setIcon(sveIkone[alt(selectedL.getIcon().options.indeks)]);
    };
    selectedL = null; 
    info.update(Relay_fluff);
}
var CILayera = 0;
var indeksiLayera = [nis_lol._leaflet_id, teritoriji_0._leaflet_id, teritoriji_1._leaflet_id, teritoriji_2._leaflet_id]; //ostavi ga tu
function controlChange(e) {
    if(selectedL instanceof L.Polygon || selectedL instanceof L.Circle){selectedL.setStyle(obicanStyle)};
    if(selectedL instanceof L.Marker){
        selectedL.setIcon(sveIkone[alt(selectedL.getIcon().options.indeks)]);
    };
    selectedL = null; 
    CILayera = indeksiLayera.indexOf(e.layer._leaflet_id)-1;
    info.update(Relay_fluff);
}

var currentZoom = null;
currentZoom = map.getZoom();
for(var i=0; i<sveIkone.length ;i++){
    sveIkone[i].options.iconSize =  [sveIkoneSize[i][0]*(2**(currentZoom+3)),sveIkoneSize[i][1]*(2**(currentZoom+3))];
    sveIkone[i].options.iconAnchor =  [sveIkoneAnchor[i][0]*(2**(currentZoom+3)),sveIkoneAnchor[i][1]*(2**(currentZoom+3))];
};
for(var i=0; i<sviMarkeri.length ;i++){
    sviMarkeri[i].setIcon(sviMarkeri[i].getIcon());
};
function resizeIkone() {
    currentZoom = map.getZoom();
    for(var i=0; i<sveIkone.length ;i++){
        sveIkone[i].options.iconSize =  [sveIkoneSize[i][0]*(2**(currentZoom+3)),sveIkoneSize[i][1]*(2**(currentZoom+3))];
        sveIkone[i].options.iconAnchor =  [sveIkoneAnchor[i][0]*(2**(currentZoom+3)),sveIkoneAnchor[i][1]*(2**(currentZoom+3))];
    };
    for(var i=0; i<sviMarkeri.length ;i++){
        sviMarkeri[i].setIcon(sviMarkeri[i].getIcon());
    };
}
for(var i=0; i<sviTeritoriji.length ;i++){
    for(var j=0; j<sviTeritoriji[i].length ;j++){
        sviTeritoriji[i][j].on('mouseover',highlightLayer);
        sviTeritoriji[i][j].on('mouseout',resetLayer);
        sviTeritoriji[i][j].on('click', clickLayer);
    }
}
for(var i=0; i<sviMarkeri.length ;i++){
    sviMarkeri[i].on('mouseover',highlightLayer);
    sviMarkeri[i].on('mouseout',resetLayer);
    sviMarkeri[i].on('click',clickLayer);
}
map.on('click', mapClick);
map.on('baselayerchange', controlChange);
map.on('zoomend', resizeIkone);
//mozda malo bolje ove html_rank i html_scar
//mozda maknut vs. i ostavit samo space

//mozda pustit propagation na hoverane teritorije?
//treba uredit battle information da bude čitljivije
//mobitel jos jednom testirat
  </script>
</body>
</html>
	